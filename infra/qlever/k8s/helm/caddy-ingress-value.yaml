# Caddy Ingress Controller - Helm Values
#
# Installation:
#   helm install \
#     --namespace caddy-system \
#     --create-namespace \
#     --repo https://caddyserver.github.io/ingress/ \
#     mycaddy \
#     caddy-ingress-controller \
#     -f helm/caddy-ingress-values.yaml
#
# Automatic HTTPS with Let's Encrypt

ingressController:
  # Ingress controller configuration
  config:
    # ⚠️ REQUIRED: Your email for Let's Encrypt notifications
    email: "your-email@example.com"
    
    # Enable automatic HTTPS (default: true)
    # Caddy automatically obtains and renews certificates
    autoHttps: true
    
    # On-demand TLS (generates certs on-the-fly)
    # Generally not needed - automatic HTTPS is better
    onDemandTLS: false
    
    # ACME server (default: Let's Encrypt production)
    # Use staging for testing: https://acme-staging-v02.api.letsencrypt.org/directory
    # acmeServer: "https://acme-v02.api.letsencrypt.org/directory"
    
    # Debug mode
    debug: false
  
  # Resource limits for ingress controller
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  
  # Replica count
  replicaCount: 2
  
  # Image configuration
  image:
    repository: ghcr.io/caddyserver/gateway
    # tag: latest  # Uncomment to pin version
    pullPolicy: IfNotPresent

# LoadBalancer service configuration
loadBalancer:
  # Service type
  type: LoadBalancer
  
  # Annotations (cloud provider specific)
  annotations: {}
    # AWS example:
    # service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
    # service.beta.kubernetes.io/aws-load-balancer-scheme: "internet-facing"
    
    # GCP example:
    # cloud.google.com/load-balancer-type: "External"
    
    # Azure example:
    # service.beta.kubernetes.io/azure-load-balancer-resource-group: "my-rg"
    # service.beta.kubernetes.io/azure-dns-label-name: "qlever-ingress"
  
  # External traffic policy
  # "Local" preserves source IP but may cause uneven load distribution
  # "Cluster" distributes evenly but source IP is lost
  externalTrafficPolicy: Cluster
  
  # LoadBalancer IP (optional - cloud provider assigns if omitted)
  # loadBalancerIP: "1.2.3.4"
  
  # Source IP ranges allowed to access LoadBalancer
  # Default: allow all (0.0.0.0/0)
  loadBalancerSourceRanges: []
    # - "10.0.0.0/8"      # Internal network
    # - "203.0.113.0/24"  # Office IP range

# Service configuration
service:
  # HTTP port
  httpPort: 80
  
  # HTTPS port
  httpsPort: 443

# Pod security context
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 1000
  seccompProfile:
    type: RuntimeDefault

# Container security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000
  capabilities:
    drop:
      - ALL

# Node selection (optional)
# nodeSelector: {}
# tolerations: []
# affinity: {}